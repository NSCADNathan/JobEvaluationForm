<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NSCAD Unit II Evaluator</title>
<style>
    :root{--bg:#f8f9fa; --card:#ffffff; --text:#212529; --mute:#6c757d; --pri:#5e35b1; --acc:#d81b60; --border:#dee2e6; --sel:#ede7f6;}
    body{font-family:'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background:var(--bg); color:var(--text); margin:0; padding-bottom:120px; line-height:1.6;}
    
    header{background:#fff; border-bottom:3px solid var(--pri); padding:15px 20px; display:flex; align-items:center; justify-content:space-between; position:sticky; top:0; z-index:100; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);}
    h1{margin:0; font-size:1.25rem; text-transform:uppercase; color:var(--pri); letter-spacing:0.5px; font-weight:800;}
    
    .header-controls{display:flex; gap:8px;}
    .action-btn{background:white; border:1px solid #ced4da; color:#495057; padding:6px 12px; cursor:pointer; font-size:0.85rem; border-radius:4px; font-weight:600; transition:all 0.2s; display:flex; align-items:center; gap:6px;}
    .action-btn:hover{background:#e9ecef;}
    .reset-btn{border-color:#c62828; color:#c62828;}
    .reset-btn:hover{background:#ffebee;}

    .container{max-width:950px; margin:30px auto; padding:0 15px;}
    .card{background:var(--card); border-radius:8px; padding:30px; border:1px solid var(--border); box-shadow:0 2px 4px rgba(0,0,0,0.05); margin-bottom:20px;}

    .guidance-box{
        background: linear-gradient(135deg, var(--pri) 0%, #7e57c2 100%);
        padding: 20px 25px;
        margin-bottom: 25px;
        border-radius: 0 12px 12px 0;
        border: 3px double rgba(255,255,255,0.4);
        border-left: none;
        box-shadow: 0 4px 12px rgba(94, 53, 177, 0.25), inset 0 1px 0 rgba(255,255,255,0.2);
        position: relative;
        margin-left: -30px;
        margin-right: -30px;
        padding-left: 55px;
    }
    .guidance-box::before{
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        border-radius: 0 12px 12px 0;
        padding: 3px;
        background: linear-gradient(45deg, rgba(255,255,255,0.3), transparent, rgba(255,255,255,0.1));
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        pointer-events: none;
    }
    .guidance-text{
        font-family: 'Georgia', 'Times New Roman', serif;
        font-style: italic;
        font-weight: 600;
        color: #ffffff;
        font-size: 1.05rem;
        line-height: 1.65;
        text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        margin: 0;
    }

    .details-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
    .input-label { display: block; font-size: 0.7rem; font-weight: 800; color: var(--mute); margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
    .input-field { width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; font-size: 1rem; box-sizing: border-box; }

    .factor-header { border-bottom: 2px solid var(--pri); margin-bottom: 20px; padding-bottom: 15px; display: flex; justify-content: space-between; align-items: flex-start; }
    .factor-title-block { flex: 1; }
    .factor-title { font-size: 1.5rem; font-weight: 800; color: var(--text); margin: 0; }
    .factor-subtitle { font-size: 0.75rem; color: var(--mute); font-style: italic; font-weight: 400; margin-top: 4px; }
    
    .guide-btn { background: white; color: var(--acc); border: 1px solid var(--acc); padding: 6px 14px; border-radius: 20px; font-weight: 700; font-size: 0.8rem; cursor: pointer; margin-top: 4px; }
    .guide-btn:hover { background: var(--acc); color: white; }

    .opt-item { border: 1px solid var(--border); border-radius: 6px; padding: 18px; cursor: pointer; background: white; transition: 0.2s; margin-bottom: 10px; display: block; width: 100%; text-align: left; box-sizing: border-box; }
    .opt-item.selected { border-color: var(--pri); background: var(--sel); border-left: 6px solid var(--pri); }
    .opt-score { background: var(--text); color: white; padding: 2px 8px; border-radius: 10px; font-weight: 700; font-size: 0.8rem; float: right; margin-left: 10px; }

    .contact-nature-group { margin-bottom: 15px; border: 1px solid var(--border); border-radius: 8px; overflow: hidden; background: #fff; }
    .contact-nature-head { background: #f1f3f5; padding: 10px 15px; font-weight: 800; font-size: 0.85rem; color: #495057; border-bottom: 1px solid var(--border); }
    .contact-row { display: grid; grid-template-columns: 1fr 120px 120px; align-items: center; border-bottom: 1px solid #f8f9fa; }
    .contact-desc { padding: 12px; font-size: 0.9rem; line-height: 1.4; color: #495057; }
    .contact-opt { padding: 12px; text-align: center; cursor: pointer; border-left: 1px solid #f1f3f5; transition: 0.2s; height: 100%; display: flex; flex-direction: column; justify-content: center; }
    .contact-opt:hover { background: #f8f9fa; }
    .contact-opt.selected { background: var(--sel); color: var(--pri); font-weight: 800; border-left: 2px solid var(--pri); }

    .sub-section{margin-top:20px; border:1px solid var(--border); border-radius:6px; padding:15px; background:#fafafa;}
    .sub-title { font-weight:800; color:var(--mute); margin-bottom:10px; font-size:0.7rem; text-transform:uppercase; letter-spacing:1px; }

    .rationale-accordion { margin-top: 15px; border: 1px solid var(--border); border-radius: 6px; background: #fdfdfd; }
    .rationale-accordion summary { padding: 12px; font-size: 0.85rem; font-weight: 700; color: var(--pri); cursor: pointer; list-style: none; display: flex; align-items: center; }
    .rationale-accordion summary::before { content: 'â–¶'; margin-right: 10px; font-size: 0.7rem; transition: 0.2s; }
    .rationale-accordion[open] summary::before { transform: rotate(90deg); }
    .rationale-text { width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-family: 'Georgia', serif; font-size: 1rem; box-sizing: border-box; resize: vertical; }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(3px); }
    .modal-content { background: white; width: 95%; max-width: 900px; max-height: 85vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; }
    .modal-body { padding: 40px; overflow-y: auto; white-space: pre-wrap; font-family: 'Georgia', serif; font-size: 1rem; line-height: 1.6; color: #2c3e50; }
    .pg-ref { color: var(--pri); font-weight: 800; font-size: 0.85rem; border-bottom: 2px solid var(--sel); padding-bottom: 10px; margin-bottom: 15px; display: block; text-transform: uppercase; }

    .salary-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
    .salary-table th, .salary-table td { border: 1px solid var(--border); padding: 10px; text-align: center; }
    .salary-table th { background: var(--text); color: white; text-transform: uppercase; font-size: 0.7rem; }
    .active-row { background: var(--sel); font-weight: 800; border: 2px solid var(--pri); }

    footer { position: fixed; bottom: 0; left: 0; width: 100%; background: white; border-top: 1px solid var(--border); padding: 15px 0; z-index: 200; box-shadow: 0 -4px 10px rgba(0,0,0,0.05); }
    .footer-inner { max-width: 950px; margin: 0 auto; padding: 0 15px; display: flex; justify-content: space-between; align-items: center; }
    .nav-btns { display: flex; gap: 10px; }

    @media print { .no-print { display: none !important; } footer { position: static; border-top: none; } .card { border: none; box-shadow: none; } }
</style>
</head>
<body>

<header class="no-print">
    <h1>Unit II Evaluator</h1>
    <div class="header-controls">
        <button class="action-btn" onclick="exportData()">ðŸ’¾ Save .nate</button>
        <button class="action-btn" onclick="document.getElementById('fileInput').click()">ðŸ“‚ Load .nate</button>
        <button class="action-btn reset-btn" onclick="hardReset()">â†º Reset</button>
        <input type="file" id="fileInput" style="display:none" onchange="importData(this)">
    </div>
</header>

<div class="container" id="app-content"></div>

<div class="modal-overlay" id="guideModal" onclick="closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header" style="padding:20px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
            <h2 id="modalTitle" style="margin:0; font-size: 1.1rem; color: var(--pri); text-transform: uppercase;">Factor Notes</h2>
            <button onclick="closeModal()" style="background:none; border:none; font-size:1.5rem; cursor:pointer;">&times;</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
    </div>
</div>

<footer class="no-print">
    <div class="footer-inner">
        <div style="display:flex; gap:30px;">
            <div><span class="input-label">Total Points</span><span id="totalPoints" style="font-size:1.4rem; font-weight:800;">0</span></div>
            <div><span class="input-label">Est. Group</span><span id="payGroup" style="font-size:1.4rem; font-weight:800; color:var(--pri); cursor:pointer; text-decoration:underline" onclick="openSal()">-</span></div>
        </div>
        <div class="nav-btns">
            <button class="action-btn" onclick="prevStep()" id="btnBack">Back</button>
            <button class="action-btn" style="background:var(--pri); color:white" onclick="nextStep()" id="btnNext">Next Factor</button>
        </div>
    </div>
</footer>

<script>
const guidanceTexts = [
    "What formal credentials does THE JOB require - not what you personally have. Evaluate what education someone would need to perform these duties competently.",
    "How many years of practical experience would someone with the right education need to handle this position's responsibilities? This is about the job's learning curve, not your personal career history.",
    "How much does this job follow established procedures vs. requiring independent problem-solving and decision-making? Think about the mental challenge and creativity the work demands.",
    "What's the scope and impact of what this position is accountable for? Think about area management, budget responsibility, and consequences of errors.",
    "What level of supervisory responsibility does this position carry? Count who reports to the role and whether it involves full supervisory duties or just monitoring.",
    "How independently does this position operate? Think about daily access to skilled supervision vs. needing to research solutions and set policy independently.",
    "Evaluate both the nature of communications (routine vs. specialized vs. confidential) and the frequency (occasional vs. daily).",
    "This factor has five separate components - evaluate each independently based on the actual work environment.",
    "What degree of care does this position require to prevent injury or harm? Think about the hazards present in the work environment.",
    "What level of hand-eye coordination and manual precision does this work require? Consider both the type of movements and whether speed matters.",
    "Evaluate both the intensity of physical exertion required and how frequently it occurs throughout the semester.",
    "How much sustained concentration and mental focus does this work demand? Think about pace, detail requirements, and ability to manage interruptions.",
    "What level of teaching responsibility does this position carry? Think about complexity of content and impact on student learning outcomes."
];

const factors = [
    {
        id:'edu', t:'1. Education', pg:'Page 2',
        notes: `Notes on Education:

1. "Degree and Diploma" refer to successful completion of accredited educational program.

2. "Equivalent" refers to formal training in a non-accredited or non-institutional setting (for example, an apprenticeship); or formal education not resulting in a degree or a diploma, (for example experiences with multiple programs in university).`,
        opts:[
            {p:13,t:"DEGREE 1",d:"Undergraduate Degree or equivalent."},
            {p:26,t:"DEGREE 2",d:"Undergraduate degree in specific skilled area or equivalent or an undergraduate degree and a diploma or apprenticeship in specific skilled area or equivalent."},
            {p:39,t:"DEGREE 3",d:"Graduate degree in specific skilled area, or equivalent."}
        ]
    },
    {
        id:'exp', t:'2. Experience', pg:'Page 3',
        notes: `Experience Definition:

This factor serves as a scale of measurement for the amount of practical experience that an average individual having the appropriate theoretical knowledge, specific education and specialized training would require to be able to perform the job duties.

Directly related experience consists of two parts: (1) the practical application of the knowledge and skills required to do the job and (2) delivery of skills and knowledge to people in a learning environment.`,
        opts:[
            {p:20,t:"DEGREE 1",d:"Up to two years directly related experience with some experience in a post-secondary setting."},
            {p:40,t:"DEGREE 2",d:"Three to four years directly related experience with some experience in post-secondary setting."},
            {p:60,t:"DEGREE 3",d:"Five or more years directly related experience with some experience in a post-secondary setting."}
        ]
    },
    {
        id:'comp', t:'3. Complexity/Judgement', pg:'Pages 4-5', hasSubtitle: true,
        notes: `FACTOR NOTES:

1. This factor deals with the range of choice of action which is within the scope of the job duties, and does not deal with the responsibility for decisions which is dealt under the Responsibility/Accountability factor.

2. Consider the initiative required in problem solving, analysis of situations and problems, the application of fundamental principles and the extent to which judgement must be exercised in deciding upon the appropriate choices of action.

3. Evaluate the judgement permitted within the parameters and constraints of the position. No consideration is given to the capabilities of the incumbent.

This factor measures:
- the extent to which the duties are performed through adherence to procedure, guidelines, predetermined routines, etc;
- the degree of analysis and interpretation required to identify issues/problems and to recommend or carry out solutions;
- creativity or ingenuity required on an ongoing basis;
- the requirement to prioritize or plan work;
- the requirement to display initiative and/or judgement;
- the variety and diversity of problems and situations.

Prioritizing is arrangement of daily schedule; Planning has a longer term connotation.

Definitions:
Limited: occasional requirement for decision making beyond standardized choices.
Moderate: ongoing requirement for some decision making in variety of duties.
High Degree: ongoing, varied requirement to make decisions and think creatively. Search for info used for the solution.
Complex: dealing with unique situations involving decision making and creative thinking. Reviewing problems occurring for the first time.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FULL DEGREE DESCRIPTIONS (VERBATIM FROM MANUAL):

DEGREE 1: Limited analysis, reasoning, problem solving, creativity or initiative is required. In many, but not all, cases, this may mean selecting the most appropriate course of action from a number possible solutions, but assignments are generally standardized. Limited planning may be involved on the job. The job requires the application of established methods or procedures. Work may involve a choice of methods.

DEGREE 2: A moderate degree of analysis, reasoning, problem solving, creativity, or initiative is required. Situations provide some opportunity for standardized solutions and some requirement to recognize and creatively define problems and/or their practical solutions. There is usually a moderate degree of variation and variety in or from daily routines. A moderate degree of planning may be necessary. The job requires adapting established methods or procedures. Work involves a choice of methods or procedures.

DEGREE 3: Interpretative skill and ongoing, reasoning, problem solving, creativity, or initiative is required. This may require using logical, evaluative thinking to define problems, collect information, establish facts and form valid solutions. Situations are diverse although not unique and offer considerable opportunity for creativity and mental challenge. Substantial planning may be required. The job requires that changes be recommended to established methods or procedures. Work involves a choice of methods or procedures or sequence of operation.

DEGREE 4: Complex and highly developed analysis, reasoning, problem solving, creativity, or initiative is required as with new technologies. Situations are often unique and typically require a great degree of mental challenge. This includes the development of methods or procedures. Complex planning may be required.

DEGREE 5: The job requires all of Degree 4 plus the recommendation of change to established policies.`,
        opts:[
            {p:25,t:"DEGREE 1",d:"Limited problem-solving. Standardized assignments with established procedures. May involve choice of methods."},
            {p:50,t:"DEGREE 2",d:"Moderate problem-solving and variety. Mix of standardized and creative solutions. Adapting established methods and procedures."},
            {p:75,t:"DEGREE 3",d:"Ongoing problem-solving in diverse situations. Requires analysis, creativity, and substantial planning. Recommends changes to methods and procedures."},
            {p:100,t:"DEGREE 4",d:"Complex problem-solving with unique situations. High mental challenge. Develops new methods and procedures."},
            {p:125,t:"DEGREE 5",d:"All of Degree 4 plus recommending changes to established policies."}
        ]
    },
    {
        id:'resp', t:'4. Responsibility/Accountability', pg:'Pages 6-7',
        notes: `Factor Notes:
Defined as the answerability for actions and the consequences thereof. Measures impact on NSCAD'S goals and its reputation.

It considers:
- The freedom to act or deviate from assigned work;
- The nature and scope of decisions made by the incumbent;
- The likelihood of error and impact of errors;
- Degree of responsibility for material resources;
- Safeguarding confidential or valuable information;
- Responsibility for verification of the work of others;
- Initiation of action to prevent injury or harm to others.

Budget Definitions:
- Small to moderate scale = $1500 - 25,000
- Large Scale: over $25,000

Other Accountability Indicators:
- Damage or loss involving equipment, supplies or property
- Disruption or delay of service
- Loss of time in detecting and correcting error
- Morale of others
- Seriousness of an error
- Embarrassment to the University or Department`,
        opts:[
            {p:18,t:"DEGREE 1",d:"Responsible for overseeing the application of a department or studio policies and procedures during their shift."},
            {p:36,t:"DEGREE 2",d:"DEGREE I functions plus responsibility for performing a full range of duties related to a separate, limited access area or function. May include signing of Time Sheets for SAs."},
            {p:54,t:"DEGREE 3",d:"Performs all duties of Degrees I and II and is responsible for performing duties and functions related to a limited aspect of a separate open access area."},
            {p:71,t:"DEGREE 4",d:"Performs all duties of Degrees I and II and is responsible for performing a full range of duties (which may include researching cost of budget items) and all functions related to a separate open access area on a regular basis."},
            {p:89,t:"DEGREE 5",d:"Oversees a complete departmental area or specialized function of limited scope in an open access area. Assumes management responsibility for area in absence of supervisor. Responsibilities may include management of grants received to supplement budget or staffing needs."},
            {p:107,t:"DEGREE 6",d:"Oversees a complete departmental area or function with multiple functions. Assumes management responsibility for area in absence of supervisor and/or is responsible for preparation and presentation of small-scale budget ($1500 - $25,000)."},
            {p:125,t:"DEGREE 7",d:"Responsible for the management of a complete departmental area or function of significant scope and is responsible for the preparation and presentation of large-scale budget (over $25,000)."}
        ]
    },
    {
        id:'supO', t:'5. Supervision of Others', pg:'Pages 8-9',
        notes: `Supervision of Others Notes:

I. Consider hours per week worked by persons supervised and levels of training required (simple vs complex tasks).

II. "Periodically" means intermittently but with reasonable regularity.

III. Supervisory responsibility must be a definitely established part of the job requirement and must not be just transient.

IV. "Normal" supervisory responsibilities must include a portion of each:
a) Planning, organizing, scheduling, and coordinating of work.
b) Assigning of work and/or personnel.
c) Maintaining quality, accuracy, quantity of work.
d) Giving advice, guidance, instructions, direction.
e) Developing of work methods, work procedures, work standards.`,
        opts:[
            {p:18,t:"DEGREE I",d:"No supervision of others. May be responsible for monitoring trained Student Assistants during their shift."},
            {p:36,t:"DEGREE 2",d:"Responsible for day to day monitoring and training of SAs; periodically assumes some normal supervisory responsibilities. Responsible for supervision of 1 - 4 Student Assistants per semester."},
            {p:54,t:"DEGREE 3",d:"All of Degree 2 and responsible for supervision of 5 or more Student Assistants per semester OR Duties include recruiting, substantial training and dismissal of SAs."},
            {p:71,t:"DEGREE 4",d:"Continuing basis, assumes some normal supervisory responsibilities. Responsible for supervision of 1 Part Time Unit II Employee or equivalent who works for less than 15 hours per week."},
            {p:89,t:"DEGREE 5",d:"All of Degree 4 plus responsible for 2 or more Part Time Unit II Employees or equivalent who work for less than 15 hours per week."},
            {p:107,t:"DEGREE 6",d:"Continuing basis, assumes normal supervisory responsibilities. Assists in recruitment, evaluation, and effective recommendation for discipline/dismissal. Responsible for 1 Full Time and 2+ Part Time Unit II Employees."},
            {p:125,t:"DEGREE 7",d:"All of Degree 6 plus responsible for 2 or more Full Time Unit II Employees. Recommends staffing needs for the area."}
        ]
    },
    {
        id:'supR', t:'6. Supervision Received', pg:'Pages 10-11',
        notes: `Supervision Received Notes and Definitions:

- Factor should consider number of persons who make demands on area and complexity of demands.

- Open access areas will have varied clients and potential conflicts.

- Factor should also consider physical location of supervisor. (Ease of expertise access vs independent decision making).

- Technicians in areas with only part-time faculty usually have more independence in setting policy.`,
        opts:[
            {p:15,t:"DEGREE 1",d:"Supervisor skilled in area available daily for interpretation, assistance, troubleshooting, etc. One supervisor; set routines."},
            {p:30,t:"DEGREE 2",d:"Skilled supervisor available daily for majority of tasks, but not for specific skilled expertise. Weekly or occasional access."},
            {p:45,t:"DEGREE 3",d:"Employee does not have daily access to skilled supervisor. Occasionally required to research solutions. Prioritizing by employee necessary from time to time."},
            {p:60,t:"DEGREE 4",d:"No daily access. Often required to research. Regular prioritizing necessary. Conflicting suggestions may require interpretation by employee."},
            {p:75,t:"DEGREE 5",d:"Works without supervision and sets policy based on the academic needs of the area."}
        ]
    },
    {
        id:'cont', t:'7. Contacts', pg:'Pages 12-13', isMatrix: true,
        notes: `Definition: Measures contacts necessary in communicating with others co-workers, public, or students tactfully and harmoniously.

Definitions:
- "Difficult or specialized nature": dealing with a subject area that is complex and typically requires specialized formal training or extensive experience to communicate meaningfully.
- "Human relations skills": persuasion, influencing, empathy, sensitivity, and understanding of behavior.
- "Confidential": for example, discussing a Performance Review report.`,
        matrix: [
            {n: "Basic Verbal", d: "Common courtesy and tact required. explaining, exchanging data or information.", o: 5, q: 10},
            {n: "Basic Verbal and Written", d: "Tact and discretion required to deal with or settle requests, complaints or clarification.", o: 15, q: 20},
            {n: "Complex Specialized Routine", d: "Complex verbal and written exchange of routine information. Tact and diplomacy required for specialized nature or problem resolution.", o: 25, q: 30},
            {n: "Complex/Confidential (Persuasion)", d: "Complex or confidential verbal and written exchange. Human relations skills required for influencing, persuading or securing cooperation.", o: 35, q: 40},
            {n: "Complex/Confidential (Negotiation)", d: "Major element of job dealing with highly sensitive issues or negotiation.", o: 45, q: 50}
        ]
    },
    {
        id:'cond', t:'8. Working Conditions', pg:'Page 14', isMulti:true,
        notes: `Definitions:
- Minor Hazards: mold, dust, older buildings; risk of minor lost time or illness.
- Major Hazards: airborne particles (fumes, smoke), toxic chemicals, dangerous machinery, electrical hazards, noise, vibrations. Carry risk of serious illness or disability.`,
        subs:[
            {id:'haz',t:'I. Hazards (Points)',opts:[{v:0.5,t:"0.5 pts: Occas. Minor"},{v:1,t:"1.0 pt: Occas. Major"},{v:2,t:"2.0 pts: Freq. Minor"},{v:3,t:"3.0 pts: Freq. Major"}]},
            {id:'unp',t:'II. Unpleasant Conditions (Interruptions)',opts:[{v:1,t:"1 pt: Few"},{v:2,t:"2 pts: Occasional"},{v:3,t:"3 pts: Frequent"}]},
            {id:'exp',t:'III. Exposure',opts:[{v:1,t:"1 pt: Occas. Unpleasant"},{v:2,t:"2 pts: Routine Upset"},{v:3,t:"3 pts: Staff & Public"}]},
            {id:'spc',t:'IV. Space',opts:[{v:1,t:"1 pt: Private"},{v:2,t:"2 pts: Part-day Private"},{v:3,t:"3 pts: Public all day"}]},
            {id:'hrs',t:'V. Working Hours',opts:[{v:1,t:"1 pt: Regular 9-5"},{v:2,t:"2 pts: Occas eves/wknds"},{v:3,t:"3 pts: Non-business shifts"}]}
        ]
    },
    {
        id:'safe', t:'9. Safety of Others', pg:'Pages 15-16',
        notes: `FACTOR NOTES:

1. Factor not seen as conflicting with Health and Safety Regulations.

2. Some jobs and locations have more potential hazards. Meanings:
- LITTLE: Closing of file drawers, fire exits clear.
- SOME: Stacking supplies, monitoring electrical overloads, wet floor signs.
- CONSIDERABLE: Providing safety guards, PPE, occasional hazardous materials.
- HIGH: Routine use of hazardous materials and/or equipment.`,
        opts:[
            {p:10,t:"DEGREE 1",d:"Little degree of care required to prevent injury or harm to others."},
            {p:20,t:"DEGREE 2",d:"Some degree of care required to prevent injury or harm to others."},
            {p:30,t:"DEGREE 3",d:"Considerable degree of care required to prevent injury or harm to others."},
            {p:40,t:"DEGREE 4",d:"High degree of care required to prevent injury or harm to others."}
        ]
    },
    {
        id:'dext', t:'10. Dexterity', pg:'Pages 17-18',
        notes: `Dexterity Definition:
Determined by speed and/or accurate hand/eye coordination in operation of tools, equipment, or machines. Frequency must select dominant activity.

FACTOR NOTES:
- Coarse movements: full hand or foot. (e.g. band saws, drills, torches).
- Fine movements: fingers. (e.g. keyboarding, repairing instruments).
- Speed: relates to coordination of movement, not volume of work.`,
        opts:[
            {p:5,t:"DEGREE 1",d:"Duties do not normally involve the operation of tools, equipment or machinery requiring fine movements. Normally do not involve above average dexterity."},
            {p:10,t:"DEGREE 2",d:"Some duties normally require accurate coarse movements OR normally require accurate fine movements where speed is a secondary consideration."},
            {p:15,t:"DEGREE 3",d:"Duties normally require accurate fine movements and where speed is a consideration. Operation of equipment is a significant responsibility."}
        ]
    },
    {
        id:'phys', t:'11. Physical Demands', pg:'Page 19',
        notes: `Intensity Measurements:
- Light: Standing, remaining in position, repetitive eyestrain, muscle activity (typing/writing).
- Moderate or Heavy: Lifting, pushing, bending, carrying.

Frequency:
- Infrequently: 1 or 2 times per semester.
- Frequently: 3 or more times per semester.`,
        opts:[
            {p:2,t:"2 Pts",d:"Light physical exertion required up to and including one hour; 3 or more times per semester."},
            {p:4,t:"4 Pts",d:"Moderate or heavy physical exertion required up to and including one hour; 3 or more times per semester."},
            {p:8,t:"8 Pts",d:"Moderate or heavy physical exertion required over one hour and up to and including two hours; 3 or more times per semester."},
            {p:12,t:"12 Pts",d:"Moderate or heavy physical exertion required in excess of two hours; 3 or more times per semester."}
        ]
    },
    {
        id:'ment', t:'12. Mental Effort', pg:'Pages 20-21',
        notes: `Intensity Definitions:
- Low/Normal: picks up where they left off; no backtracking; low need for detail.
- Moderate: spends some time backtracking to pick up where left off; moderate need for detail.
- High: Close attention most/all time; spend considerable time backtracking; high need for detail.

Duration Definitions:
- Short: 1 hour or less.
- Moderate: >1 hour but <2 hours.
- Long: >2 hours.`,
        opts:[
            {p:20,t:"DEGREE 1",d:"Duties require low/normal concentration necessary for error free work. Occasional short periods of concentration."},
            {p:40,t:"DEGREE 2",d:"Moderate concentration for short duration although there may be occasional periods for sustained duration (i.e. > 1 hr). Pace normal most of day."},
            {p:60,t:"DEGREE 3",d:"Moderate/high concentration for periods of two to three hours for special projects or deadlines. Pace usually busy."},
            {p:80,t:"DEGREE 4",d:"High concentration for most of the day (due to volume, deadlines, exactness). Pace extremely hectic."}
        ]
    },
    {
        id:'inst', t:'13. Instruction Delivery', pg:'Pages 22-23',
        notes: `Factor Notes:
Instruction is always in response to curricular needs of classes. Does not include evaluation or grading of students. Categories:
- Assisting students one-on-one.
- Demonstrating techniques pre-arranged or routine.
- Responding to needs of program via software/tool modifications.

Scope Consideration: library routines, moderately difficult procedures, very complex techniques.`,
        opts:[
            {p:25,t:"DEGREE 1",d:"Gives instructions to new students on proper use of area. Not a complex series of steps."},
            {p:50,t:"DEGREE 2",d:"Employee expected to assist students one-on-one with techniques in materials, software, or equipment. Moderately complex steps."},
            {p:75,t:"DEGREE 3",d:"Expected to give full class or one-on-one instruction. May have to provide documentation or instructional charts."},
            {p:100,t:"DEGREE 4",d:"Give full class or one-on-one instruction on demand for complex procedures. Directly affect students' abilities to master curriculum."}
        ]
    }
];

const banding = [{g:1,r:"0 - 460"},{g:2,r:"461 - 510"},{g:3,r:"511 - 560"},{g:4,r:"561 - 610"},{g:5,r:"611 - 660"},{g:6,r:"661 - 710"},{g:7,r:"711 - 760"},{g:8,r:"761+"}];
const salaryGrid = [
    {g:1,s:["$47,907","$49,621","$51,336","$53,051","$54,765","$56,480","-","-"]},
    {g:2,s:["$51,336","$53,051","$54,765","$56,480","$58,195","$59,909","$61,624","$63,339"]},
    {g:3,s:["$54,765","$56,480","$58,195","$59,909","$61,624","$63,339","$65,053","$66,768"]},
    {g:4,s:["$58,195","$59,909","$61,624","$63,339","$65,053","$66,768","$68,483","$70,197"]},
    {g:5,s:["$61,624","$63,339","$65,053","$66,768","$68,483","$70,197","$71,912","$73,627"]},
    {g:6,s:["$65,053","$66,768","$68,483","$70,197","$71,912","$73,627","$75,341","$77,056"]},
    {g:7,s:["$68,483","$70,197","$71,912","$73,627","$75,341","$77,056","$78,771","$80,485"]},
    {g:8,s:["$71,912","$73,627","$75,341","$77,056","$78,771","$80,485","$82,200","$83,915"]}
];

let cur = 0, scores = {}, rationales = {}, userData = { name: "", position: "", date: new Date().toLocaleDateString() };

function render() {
    const el = document.getElementById('app-content');
    if (cur >= factors.length) { renderSummary(el); return; }
    const f = factors[cur];
    
    let profile = cur === 0 ? `<div class="card">
        <div class="details-grid">
            <div><label class="input-label">Member Name</label><input type="text" class="input-field" value="${userData.name}" oninput="userData.name=this.value; save();" placeholder="Full Name"></div>
            <div><label class="input-label">Job Title</label><input type="text" class="input-field" value="${userData.position}" oninput="userData.position=this.value; save();" placeholder="Current Position"></div>
        </div>
    </div>` : "";

    let opts = "";
    if (f.isMatrix) {
        opts = f.matrix.map(row => `
            <div class="contact-nature-group">
                <div class="contact-nature-head">${row.n}</div>
                <div class="contact-row">
                    <div class="contact-desc">${row.d}</div>
                    <div class="contact-opt ${scores[f.id]===row.o?'selected':''}" onclick="setScore('${f.id}', ${row.o})">Occasional<br><small>${row.o} pts</small></div>
                    <div class="contact-opt ${scores[f.id]===row.q?'selected':''}" onclick="setScore('${f.id}', ${row.q})">Daily<br><small>${row.q} pts</small></div>
                </div>
            </div>`).join('');
    } else if (f.isMulti) {
        opts = f.subs.map(s => `<div class="sub-section"><div class="sub-title">${s.t}</div><div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">${s.opts.map(o => `<div class="opt-item ${scores[f.id+'_'+s.id]===o.v?'selected':''}" style="margin:0; text-align:center" onclick="setSubScore('${f.id}','${s.id}',${o.v})">${o.t}</div>`).join('')}</div></div>`).join('');
    } else {
        opts = f.opts.map(o => `<div class="opt-item ${scores[f.id]===o.p?'selected':''}" onclick="setScore('${f.id}',${o.p})"><span class="opt-score">${o.p} pts</span><strong>${o.t}</strong><div style="margin-top:8px; font-size:0.95rem; color:#495057;">${o.d}</div></div>`).join('');
    }

    let titleBlock = f.hasSubtitle ? 
        `<div class="factor-title-block"><h2 class="factor-title">${f.t}</h2><div class="factor-subtitle">(degrees are simplified for ease of use. Consult Factor Notes for full descriptions)</div></div>` :
        `<h2 class="factor-title">${f.t}</h2>`;

    el.innerHTML = profile + `
        <div class="card">
            <div class="guidance-box">
                <p class="guidance-text">${guidanceTexts[cur]}</p>
            </div>
            <div class="factor-header">
                ${titleBlock}
                <button class="guide-btn" onclick="openManual(${cur})">View Factor Notes</button>
            </div>
            <div class="options-list">${opts}</div>
            <details class="rationale-accordion" ${rationales[f.id]?'open':''}>
                <summary>Rationale & Evidence</summary>
                <div style="padding:15px"><textarea class="rationale-text" rows="4" oninput="rationales['${f.id}']=this.value; save();" placeholder="Enter verbatim text or evidence from current JD...">${rationales[f.id]||''}</textarea></div>
            </details>
        </div>`;
    window.scrollTo(0,0);
}

function setScore(id, v) { scores[id] = v; save(); updateFooter(); render(); }
function setSubScore(fid, sid, v) { scores[fid+'_'+sid] = v; save(); updateFooter(); render(); }
function getFactorTotal(f) { return f.isMulti ? f.subs.reduce((a,s)=>a+(scores[f.id+'_'+s.id]||0),0) : (scores[f.id]||0); }
function calcT() { return factors.reduce((a,f)=>a+getFactorTotal(f),0); }

function getG(t) { 
    if (t >= 761) return 8; 
    if (t >= 711) return 7; 
    if (t >= 661) return 6; 
    if (t >= 611) return 5; 
    if (t >= 561) return 4; 
    if (t >= 511) return 3; 
    if (t >= 461) return 2; 
    return 1; 
}

function updateFooter() { 
    let t = calcT(); 
    document.getElementById('totalPoints').innerText = t.toFixed(1); 
    document.getElementById('payGroup').innerText = "Group " + getG(t); 
}

function renderSummary(el) {
    let t = calcT();
    el.innerHTML = `<div class="card"><h2>Evaluation Summary</h2><table style="width:100%;border-collapse:collapse">${factors.map(f=>`<tr><td style="padding:10px;border-bottom:1px solid #eee"><strong>${f.t}</strong></td><td style="text-align:right; font-weight:700">${getFactorTotal(f)} pts</td></tr><tr><td colspan="2" style="padding:0 0 15px 10px;color:#666;font-size:0.85rem"><em>${rationales[f.id]||'No evidence listed.'}</em></td></tr>`).join('')}</table><div style="margin-top:20px; padding:20px; background:var(--sel); border:2px solid var(--pri); text-align:center; border-radius:8px;"><div style="font-size:2.5rem; font-weight:800;">${t.toFixed(1)} Points</div><div style="font-size:1.5rem; font-weight:700; color:var(--pri)">Group ${getG(t)}</div></div><button class="action-btn" onclick="window.print()" style="width:100%;margin-top:20px;background:var(--pri);color:white;justify-content:center">Print PDF Report</button></div>`;
}

function openManual(i) {
    document.getElementById('modalTitle').innerText = factors[i].t + " Notes";
    document.getElementById('modalBody').innerHTML = `<span class="pg-ref">Manual Reference: ${factors[i].pg}</span>` + factors[i].notes;
    document.getElementById('guideModal').style.display = 'flex';
}

function openSal() {
    let g = getG(calcT());
    let b = document.getElementById('modalBody');
    document.getElementById('modalTitle').innerText = "Salary Grid (July 1, 2025)";
    let html = `<table class="salary-table"><thead><tr><th>Group</th><th>Points Range</th><th>Step 1</th><th>Step 2</th><th>Step 3</th><th>Step 4</th><th>Step 5</th><th>Step 6</th><th>Step 7</th><th>Step 8</th></tr></thead><tbody>`;
    salaryGrid.forEach(r => {
        let range = banding.find(band => band.g === r.g).r;
        html += `<tr class="${r.g === g ? 'active-row' : ''}"><td>Group ${r.g}</td><td style="background:#f1f3f5; font-weight:bold">${range}</td>`;
        for (let i = 0; i < 8; i++) html += `<td>${r.s[i] || "-"}</td>`;
        html += `</tr>`;
    });
    b.innerHTML = html + `</tbody></table>`;
    document.getElementById('guideModal').style.display = 'flex';
}

function closeModal() { document.getElementById('guideModal').style.display = 'none'; }
function save() { localStorage.setItem('nscad_classic_complete_v1', JSON.stringify({scores, rationales, userData})); }
function nextStep() { if(cur < factors.length) { cur++; render(); } }
function prevStep() { if(cur > 0) { cur--; render(); } }
function hardReset() { if(confirm("Clear evaluation data and start over?")) { scores={}; rationales={}; userData={name:"",position:"",date:new Date().toLocaleDateString()}; save(); cur=0; render(); updateFooter(); } }
function exportData() { let b = new Blob([JSON.stringify({ scores, rationales, userData })], {type:"text/plain"}); let a = document.createElement("a"); a.href=URL.createObjectURL(b); a.download=`Eval_${userData.name||'Member'}.nate`; a.click(); }
function importData(i) { let r = new FileReader(); r.onload=(e)=>{ let d=JSON.parse(e.target.result); scores=d.scores; rationales=d.rationales; userData=d.userData; cur=0; render(); updateFooter(); }; r.readAsText(i.files[0]); }

window.onload = () => {
    const saved = localStorage.getItem('nscad_classic_complete_v1');
    if(saved) { const d = JSON.parse(saved); scores=d.scores; rationales=d.rationales; userData=d.userData; }
    render(); updateFooter();
};
</script>
</body>
</html>
