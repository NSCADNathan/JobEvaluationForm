<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NSCAD Unit II Evaluator (Verbatim Manual Edition)</title>
<style>
    :root{--bg:#f8f9fa; --card:#ffffff; --text:#212529; --mute:#6c757d; --pri:#5e35b1; --acc:#d81b60; --border:#dee2e6; --sel:#ede7f6;}
    body{font-family:'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background:var(--bg); color:var(--text); margin:0; padding-bottom:120px; line-height:1.6;}
    
    header{background:#fff; border-bottom:3px solid var(--pri); padding:15px 20px; display:flex; align-items:center; justify-content:space-between; position:sticky; top:0; z-index:100; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);}
    h1{margin:0; font-size:1.25rem; text-transform:uppercase; color:var(--pri); letter-spacing:0.5px; font-weight:800;}
    
    .header-controls{display:flex; gap:8px;}
    .action-btn{background:white; border:1px solid #ced4da; color:#495057; padding:6px 12px; cursor:pointer; font-size:0.85rem; border-radius:4px; font-weight:600; transition:all 0.2s; display:flex; align-items:center; gap:6px; white-space:nowrap;}
    .action-btn:hover{background:#e9ecef; transform:translateY(-1px);}
    .reset-btn{border-color:#c62828; color:#c62828;}
    .reset-btn:hover{background:#ffebee;}

    .container{max-width:900px; margin:30px auto; padding:0 15px;}
    .card{background:var(--card); border-radius:8px; padding:30px; border:1px solid var(--border); box-shadow:0 2px 4px rgba(0,0,0,0.05); margin-bottom:20px;}

    .profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border); }
    .profile-icon { background: var(--sel); color: var(--pri); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: 800; border: 2px solid var(--pri); }
    .details-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .input-group { margin-bottom: 15px; }
    .input-label { display: block; font-size: 0.7rem; font-weight: 800; color: var(--mute); margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
    .input-field { width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; font-size: 1rem; color: var(--text); box-sizing: border-box; background: #fff; }

    .factor-header { border-bottom: 2px solid var(--pri); margin-bottom: 20px; padding-bottom: 15px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
    .factor-title { font-size: 1.5rem; font-weight: 800; color: var(--text); margin: 0; }
    
    .guide-btn-group { display: flex; gap: 8px; }
    .guide-btn { background: white; color: var(--pri); border: 1px solid var(--pri); padding: 6px 14px; border-radius: 20px; font-weight: 700; font-size: 0.8rem; cursor: pointer; transition: 0.2s; }
    .guide-btn:hover { background: var(--pri); color: white; }
    .guide-btn.full { border-color: var(--acc); color: var(--acc); }
    .guide-btn.full:hover { background: var(--acc); color: white; }

    .opt-item { border: 1px solid var(--border); border-radius: 6px; padding: 15px; cursor: pointer; background: white; transition: 0.2s; margin-bottom: 10px; }
    .opt-item.selected { border-color: var(--pri); background: var(--sel); border-left: 6px solid var(--pri); }
    .opt-head { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 6px; }
    .opt-name { font-weight: 700; font-size: 1.05rem; color: var(--pri); }
    .opt-score { background: var(--text); color: white; padding: 2px 8px; border-radius: 10px; font-weight: 700; font-size: 0.8rem; }
    .opt-desc { font-size: 0.95rem; color: #495057; }

    .sub-section{margin-top:20px; border:1px solid var(--border); border-radius:6px; padding:15px; background:#fafafa;}
    .sub-title{font-weight:800; color:var(--mute); margin-bottom:10px; font-size:0.75rem; text-transform:uppercase; letter-spacing:1px;}

    .rationale-accordion { margin-top: 15px; border: 1px solid var(--border); border-radius: 6px; background: #fdfdfd; }
    .rationale-accordion summary { padding: 12px; font-size: 0.85rem; font-weight: 700; color: var(--pri); cursor: pointer; list-style: none; display: flex; align-items: center; }
    .rationale-accordion summary::before { content: 'â–¶'; display: inline-block; margin-right: 10px; transition: transform 0.2s; font-size: 0.7rem; }
    .rationale-accordion[open] summary::before { transform: rotate(90deg); }
    .rationale-content { padding: 0 15px 15px 15px; border-top: 1px solid var(--border); padding-top: 15px; }
    .rationale-text { width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-family: 'Georgia', serif; font-size: 1rem; resize: vertical; box-sizing: border-box; }

    footer { position: fixed; bottom: 0; left: 0; width: 100%; background: white; border-top: 1px solid var(--border); padding: 15px 0; z-index: 200; box-shadow: 0 -4px 10px rgba(0,0,0,0.05); }
    .footer-inner { max-width: 900px; margin: 0 auto; padding: 0 15px; display: flex; justify-content: space-between; align-items: center; }
    .nav-btns { display: flex; gap: 10px; }
    .stat-num { font-size: 1.4rem; font-weight: 800; }
    .pay-group-display { color: var(--pri); font-weight: 800; text-decoration: underline; cursor: pointer; }

    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(3px); }
    .modal-content { background: white; width: 95%; max-width: 900px; max-height: 85vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; }
    .modal-header { padding: 20px; background: var(--bg); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .modal-body { padding: 30px; overflow-y: auto; white-space: pre-wrap; font-family: 'Georgia', serif; font-size: 1.05rem; line-height: 1.7; color: #2c3e50; }
    .pg-ref { color: var(--pri); font-weight: 800; font-size: 0.85rem; border-bottom: 2px solid var(--sel); padding-bottom: 10px; margin-bottom: 15px; display: block; }

    .summary-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .summary-table th { border-bottom: 2px solid var(--pri); padding: 10px; text-align: left; color: var(--pri); font-size: 0.8rem; text-transform: uppercase; }
    .summary-table td { border-bottom: 1px solid var(--border); padding: 15px 10px; vertical-align: top; }
    .summary-evidence { font-family: 'Georgia', serif; font-size: 0.9rem; color: #444; background: #fcfcfc; padding: 8px; border-radius: 4px; border-left: 3px solid var(--border); }

    .salary-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
    .salary-table th, .salary-table td { border: 1px solid var(--border); padding: 8px; text-align: center; }
    .salary-table th { background: var(--text); color: white; }
    .active-row { background: var(--sel); font-weight: 800; border: 2px solid var(--pri); }
    .pts-range-col { background: #f0f0f0; font-weight: bold; color: var(--pri); }

    @media print {
        header, footer, .guide-btn, .header-controls, .rationale-accordion summary { display: none !important; }
        .rationale-accordion { border: none; background: none; }
        .card { border: none; box-shadow: none; padding: 0; }
    }
</style>
</head>
<body>

<header>
    <h1>Unit II Evaluator</h1>
    <div class="header-controls">
        <button class="action-btn" onclick="document.getElementById('fileInput').click()">ðŸ“‚ Load .nate</button>
        <button class="action-btn" onclick="exportData()" style="color:var(--pri); border-color:var(--pri);">ðŸ’¾ Save .nate</button>
        <button class="action-btn reset-btn" onclick="hardReset()">â†º Reset</button>
        <input type="file" id="fileInput" accept=".nate" style="display:none" onchange="importData(this)">
    </div>
</header>

<div class="container" id="app-content"></div>

<div class="modal-overlay" id="guideModal">
    <div class="modal-content">
        <div class="modal-header"><h2 id="modalTitle" style="margin:0;">Guidebook</h2><button onclick="closeModal('guideModal')" style="background:none; border:none; font-size:2rem; cursor:pointer;">&times;</button></div>
        <div class="modal-body" id="modalBody"></div>
    </div>
</div>

<div class="modal-overlay" id="salaryModal">
    <div class="modal-content">
        <div class="modal-header"><h2 style="margin:0;">Salary Grid & Point Ranges</h2><button onclick="closeModal('salaryModal')" style="background:none; border:none; font-size:2rem; cursor:pointer;">&times;</button></div>
        <div class="modal-body">
            <table class="salary-table">
                <thead><tr><th>Group</th><th class="pts-range-col">Points Range</th><th>Step 1</th><th>Step 2</th><th>Step 3</th><th>Step 4</th><th>Step 5</th><th>Step 6</th><th>Step 7</th><th>Step 8</th></tr></thead>
                <tbody id="salaryBody"></tbody>
            </table>
        </div>
    </div>
</div>

<footer>
    <div class="footer-inner">
        <div style="display:flex; gap:30px;">
            <div><span style="font-size:0.7rem; text-transform:uppercase; color:var(--mute); font-weight:800;">Total Points</span><br><span class="stat-num" id="totalPoints">0</span></div>
            <div><span style="font-size:0.7rem; text-transform:uppercase; color:var(--mute); font-weight:800;">Est. Group</span><br><span class="stat-num pay-group-display" id="payGroup" onclick="openSal()">-</span></div>
        </div>
        <div class="nav-btns">
            <button class="action-btn" onclick="prevStep()" id="btnBack">Back</button>
            <button class="action-btn" style="background:var(--pri); color:white;" onclick="nextStep()" id="btnNext">Next</button>
        </div>
    </div>
</footer>

<script>
const factors = [
    {
        id:'edu', t:'1. Education', pg:'Page 2',
        sum: `DEGREE 1: Undergraduate Degree or equivalent.\nDEGREE 2: Undergraduate degree in specific skilled area or equivalent or an undergraduate degree and a diploma or apprenticeship in specific skilled area or equivalent.\nDEGREE 3: Graduate degree in specific skilled area, or equivalent.`,
        full: `EDUCATION\n\nDEGREE 1\nUndergraduate Degree or equivalent.\n\nDEGREE 2\nUndergraduate degree in specific skilled area or equivalent or an undergraduate degree and a diploma or apprenticeship in specific skilled area or equivalent.\n\nDEGREE 3\nGraduate degree in specific skilled area, or equivalent.\n\nNotes on Education:\n1. "Degree and Diploma" refer to successful completion of accredited educational program.\n2. "Equivalent" refers to formal training in a non-accredited or non-institutional setting (for example, an apprenticeship); or formal education not resulting in a degree or a diploma, (for example experiences with multiple programs in university).`,
        opts:[{p:13,t:"Degree 1",d:"Undergrad or equivalent."},{p:26,t:"Degree 2",d:"Specific Undergrad / Diploma / Apprenticeship."},{p:39,t:"Degree 3",d:"Specific Graduate Degree."}]
    },
    {
        id:'exp', t:'2. Experience', pg:'Page 3',
        sum: `DEGREE 1: Up to two years directly related experience.\nDEGREE 2: Three to four years directly related experience.\nDEGREE 3: Five or more years directly related experience.`,
        full: `EXPERIENCE\n\nDEGREE 1\nUp to two years directly related experience with some experience in a post-secondary setting.\n\nDEGREE 2\nThree to four years directly related experience with some experience in post-secondary setting.\n\nDEGREE 3\nFive or more years directly related experience with some experience in a post-secondary setting.\n\nExperience Definition:\nThis factor serves as a scale of measurement for the amount of practical experience that an average individual having the appropriate theoretical knowledge, specific education and specialized training would require to be able to perform the job duties.\n\nDirectly related experience consists of two parts: (1) the practical application of the knowledge and skills required to do the job and (2) delivery of skills and knowledge to people in a learning environment.`,
        opts:[{p:20,t:"Degree 1",d:"Up to 2 years."},{p:40,t:"Degree 2",d:"3-4 years."},{p:60,t:"Degree 3",d:"5+ years."}]
    },
    {
        id:'comp', t:'3. Complexity/Judgement', pg:'Pages 4-5',
        sum: `Measures the requirement for decision making and thinking. Levels range from "Limited" (standardized choices) to "Complex" (unique situations, new technologies).`,
        full: `PROBLEM SOLVING/COMPLEXITY/JUDGEMENT\n\nDEGREE 1\nLimited analysis, reasoning, problem solving, creativity or initiative is required. In many, but not all, cases, this may mean selecting the most appropriate course of action from a number of possible solutions, but assignments are generally standardized. Limited planning may be involved on the job. The job requires the application of established methods or procedures. Work may involve a choice of methods.\n\nDEGREE 2\nA moderate degree of analysis, reasoning, problem solving, creativity, or initiative is required. Situations provide some opportunity for standardized solutions and some requirement to recognize and creatively define problems and/or their practical solutions. There is usually a moderate degree of variation and variety in or from daily routines. A moderate degree of planning may be necessary. The job requires adapting established methods or procedures. Work involves a choice of methods or procedures.\n\nDEGREE 3\nInterpretative skill and ongoing, reasoning, problem solving, creativity, or initiative is required. This may require using logical, evaluative thinking to define problems, collect information, establish facts and form valid solutions. Situations are diverse although not unique and offer considerable opportunity for creativity and mental challenge. Substantial planning may be required. The job requires that changes be recommended to established methods or procedures. Work involves a choice of methods or procedures or sequence of operation.\n\nDEGREE 4\nComplex and highly developed analysis, reasoning, problem solving, creativity, or initiative is required as with new technologies. Situations are often unique and typically require a great degree of mental challenge. This includes the development of methods or procedures. Complex planning may be required.\n\nDEGREE 5\nThe job requires all of Degree 4 plus the recommendation of change to established policies.\n\nFACTOR NOTES:\n- This factor deals with the range of choice of action within the scope of duties.\n- It considers analysis required to identify issues, creativity/ingenuity required, and the variety of situations.\n- DEFINITIONS:\n  - Limited: Occasional requirement for decision making beyond standardized choices.\n  - Moderate: Ongoing requirement for some decision making in a variety of duties.\n  - High Degree: Ongoing, varied requirement to think creatively and search for information.\n  - Complex: Dealing with unique situations and problems occurring for the first time (research, new technology, etc).`,
        opts:[{p:25,t:"Degree 1",d:"Limited analysis, standardized assignments."},{p:50,t:"Degree 2",d:"Moderate analysis, choice of methods."},{p:75,t:"Degree 3",d:"Interpretative skill, diverse situations, substantial planning."},{p:100,t:"Degree 4",d:"Complex analysis for unique situations/technologies."},{p:125,t:"Degree 5",d:"Degree 4 + policy changes."}]
    },
    {
        id:'resp', t:'4. Responsibility', pg:'Pages 6-7',
        sum: `Measures answerability for actions. Considers budget size (Small: $1.5k-$25k; Large: >$25k), likelihood of error, and impact on reputation.`,
        full: `RESPONSIBILITY/ACCOUNTABILITY\n\nDEGREE 1: Responsible for overseeing the application of a department or studio policies and procedures during their shift.\nDEGREE 2: DEGREE I functions plus responsibility for performing a full range of duties related to a separate, limited access area or function. May include signing of Time Sheets for SAs.\nDEGREE 3: Performs all duties of Degree I/II and is responsible for duties related to a limited aspect of a separate open access area.\nDEGREE 4: Responsible for full range of duties related to a separate open access area on a regular basis (may include researching cost of budget items).\nDEGREE 5: Oversees complete departmental area or specialized function of limited scope in an open access area. Assumes management in absence of supervisor.\nDEGREE 6: Oversees complete departmental area with multiple functions. Responsible for small-scale budget.\nDEGREE 7: Management of a complete departmental area of significant scope; responsible for large-scale budget.\n\nFACTOR NOTES:\n- Measures impact on achievement of NSCAD'S goals and its reputation.\n- Accountability indicators:\n  - Small to moderate scale budget: $1500 - $25,000\n  - Large scale budget: over $25,000\n- Also considers: freedom to act, likelihood/impact of error, and responsibility for material resources or safeguarding confidential info.`,
        opts:[{p:18,t:"Degree 1",d:"Overseeing shift policy."},{p:36,t:"Degree 2",d:"Full range, limited access area."},{p:54,t:"Degree 3",d:"Aspect of open access area."},{p:71,t:"Degree 4",d:"Full range open access (regular)."},{p:89,t:"Degree 5",d:"Oversees specialized function."},{p:107,t:"Degree 6",d:"Multiple functions / small-mid budget."},{p:125,t:"Degree 7",d:"Significant scope / large budget."}]
    },
    {
        id:'supO', t:'5. Supervision Given', pg:'Pages 8-9',
        sum: `Covers monitoring of SAs to managing Full-Time Unit II staff. "Normal" supervision includes planning, assigning work, and guidance.`,
        full: `SUPERVISION OF OTHERS\n\nDEGREE I: No supervision of others. May monitor trained Student Assistants.\nDEGREE 2: Responsible for day to day monitoring and training of SAs (1-4 SAs per semester).\nDEGREE 3: Supervision of 5 or more SAs per semester OR duties include recruiting, training, and dismissal of SAs.\nDEGREE 4: On continuing basis, assumes some normal supervisory responsibilities. Supervision of 1 Part Time Unit II (<15 hrs/wk).\nDEGREE 5: Supervision of 2 or more Part Time Unit II employees (<15 hrs/wk).\nDEGREE 6: Assumes normal supervisory responsibilities for 1 Full Time Unit II and 2+ Part Time Unit II employees.\nDEGREE 7: Responsible for 2 or more Full Time Unit II employees.\n\nNOTES:\n- "Normal" supervisory responsibilities must include a portion of:\n  a) Planning, organizing, scheduling, coordinating work.\n  b) Assigning work/personnel.\n  c) Maintaining quality and accuracy.\n  d) Giving advice, guidance, instructions.\n  e) Developing work methods and standards.`,
        opts:[{p:18,t:"Degree 1",d:"No supervision."},{p:36,t:"Degree 2",d:"1-4 SAs."},{p:54,t:"Degree 3",d:"5+ SAs OR hiring duties."},{p:71,t:"Degree 4",d:"1 PT Unit II."},{p:89,t:"Degree 5",d:"2+ PT Unit II."},{p:107,t:"Degree 6",d:"1 FT + 2+ PT Unit II."},{p:125,t:"Degree 7",d:"2+ FT Unit II."}]
    },
    {
        id:'supR', t:'6. Supervision Rec\'d', pg:'Pages 10-11',
        sum: `Considers supervisor availability and access to expertise. Technicians with sessional/PT faculty often have more independence.`,
        full: `SUPERVISION RECEIVED\n\nDEGREE 1: Supervisor skilled in area is available daily. Interpretation and troubleshooting assistance is daily.\nDEGREE 2: Supervisor skilled in area available daily for majority of tasks, but not for specific area of expertise. Weekly/occasional access.\nDEGREE 3: Employee does not have daily access to skilled supervisor. Occasionally required to research solutions. Work routine available but prioritizing by employee is necessary.\nDEGREE 4: Does not have daily access. Often required to research. Prioritizing necessary on a regular basis. Conflicting suggestions may require interpretation.\nDEGREE 5: Employee works without supervision and sets policy based on academic needs of the area.\n\nNOTES:\n- "Supervisor" is not always one person; consider the number of people making demands on the area.\n- Open access areas present more potential conflicts than closed areas.\n- Physical location of supervisor matters (ease of requesting assistance vs independent decision making).`,
        opts:[{p:15,t:"Degree 1",d:"Daily access, skilled supervisor."},{p:30,t:"Degree 2",d:"Daily majority; specific weekly."},{p:45,t:"Degree 3",d:"No daily access; prioritize intermittently."},{p:60,t:"Degree 4",d:"No daily access; prioritize regularly."},{p:75,t:"Degree 5",d:"Works without supervision; sets policy."}]
    },
    {
        id:'cont', t:'7. Contacts', pg:'Pages 12-13',
        sum: `Measures verbal/written communication skill and tact. Higher levels involve complex/confidential info and sensitive human relations skills.`,
        full: `CONTACTS\n\nMeasures contacts necessary in communicating with others, co-workers, public, or students. Oral or written.\n\nDEGREES 1-2: Basic verbal contacts. Common courtesy required. Frequency occasional (1) or moderate/daily (2).\nDEGREES 3-4: Basic verbal and written. Tact and discretion required for settled requests or complaints. Frequency occasional (3) or moderate/daily (4).\nDEGREES 5-6: Complex verbal/written exchange of routine info. Tact and diplomacy required for resolution of problems. Frequency occasional (5) or moderate/daily (6).\nDEGREES 7-8: Complex or confidential exchange. Tact, diplomacy, and human relations skills required for influencing or persuading. Frequency occasional (7) or moderate/daily (8).\nDEGREES 9-10: Complex/confidential exchange. Major element of job requiring considerable human relations skills for negotiating or sensitive issues. Frequency occasional (9) or moderate/daily (10).\n\nDEFINITIONS:\n- "Difficult/Specialized": Subject area is complex; requires specialized training or extensive experience to communicate meaningfully.\n- "Human relations skills": Persuasion, influenced, empathy, sensitivity, and understanding of behavior.\n- "Confidential": E.g. Performance reviews.`,
        opts:[{p:5,t:"Degree 1",d:"Basic verbal; occasional."},{p:15,t:"Degree 3",d:"Basic verbal/written; tact; occasional."},{p:30,t:"Degree 6",d:"Complex routine info; daily."},{p:40,t:"Degree 8",d:"Confidential/Complex info; daily."},{p:50,t:"Degree 10",d:"Sensitive issues; daily; major element."}]
    },
    {
        id:'cond', t:'8. Working Conditions', pg:'Page 14', isMulti:true,
        sum: `Calculated sum of 5 categories: Hazards, Interruptions, Exposure, Space, and Hours.`,
        full: `WORKING CONDITIONS\n\nI. HAZARDS (0.5 - 3)\n- Minor Hazards: mold, dust, older buildings; risk of minor lost time.\n- Major Hazards: airborne particles (fumes, sawdust, smoke), toxic chemicals, dangerous machinery, electrical hazards, noise, vibrations; risk of serious illness or disability.\na1) Occasional Minor: 0.5\na2) Occasional Major: 1.0\nb) Frequent Minor: 2.0\nc) Frequent Major: 3.0\n\nII. UNPLEASANT CONDITIONS (1 - 3)\n- Few interruptions: 1\n- Occasional interruptions: 2\n- Frequent interruptions: 3\n\nIII. EXPOSURE (1 - 3)\n- Occasional unpleasant staff: 1\n- Routine encounters with upset staff: 2\n- Routine encounters with upset staff AND general public: 3\n\nIV. SPACE (1 - 3)\n- Private space: 1\n- Part-day private: 2\n- Public space all day: 3\n\nV. WORKING HOURS (1 - 3)\n- Regular 9-5 M-F: 1\n- Occasional eves/wknds or regular non-business shifts: 2\n- Always works during non-business hours: 3`,
        subs:[
            {id:'haz',t:'I. Hazards',opts:[{v:0.5,t:"Occasional Minor"},{v:1,t:"Occasional Major"},{v:2,t:"Frequent Minor"},{v:3,t:"Frequent Major"}]},
            {id:'unp',t:'II. Interruptions',opts:[{v:1,t:"Few"},{v:2,t:"Occasional"},{v:3,t:"Frequent"}]},
            {id:'exp',t:'III. Exposure',opts:[{v:1,t:"Occasional Unpleasant"},{v:2,t:"Routine Upset Staff"},{v:3,t:"Routine Upset Staff & Public"}]},
            {id:'spc',t:'IV. Space',opts:[{v:1,t:"Private space"},{v:2,t:"Part-day private"},{v:3,t:"Public space all day"}]},
            {id:'hrs',t:'V. Hours',opts:[{v:1,t:"Regular 9-5"},{v:2,t:"Occasional Eves/Wknds"},{v:3,t:"Always non-business"}]}
        ]
    },
    {
        id:'safe', t:'9. Safety of Others', pg:'Pages 15-16',
        sum: `Measures care required to prevent injury. Ranges from "Little" (fire exits) to "High" (routine hazardous materials).`,
        full: `SAFETY OF OTHERS\n\nThis factor measures the degree of care required to prevent injury or harm to others.\n\nDEGREE 1: Little degree of care required.\nDEGREE 2: Some degree of care required.\nDEGREE 3: Considerable degree of care required.\nDEGREE 4: High degree of care required.\n\nFACTOR NOTES:\n- LITTLE: Closing file drawers, keeping fire exits clear.\n- SOME: Stacking supplies, monitoring electrical overloads, posting wet floor signs.\n- CONSIDERABLE: Providing safety guards, PPE, and occasional use of hazardous materials.\n- HIGH: Routine use of hazardous materials and/or equipment.`,
        opts:[{p:10,t:"Degree 1",d:"Little care required."},{p:20,t:"Degree 2",d:"Some care required."},{p:30,t:"Degree 3",d:"Considerable care; PPE/Guards."},{p:40,t:"Degree 4",d:"High degree of care; routine hazards."}]
    },
    {
        id:'dext', t:'10. Dexterity', pg:'Pages 17-18',
        sum: `Speed and coordination in using tools. "Coarse" (saws/drills) vs "Fine" (keyboarding/instrument repair).`,
        full: `DEXTERITY\n\nMeasures level of speed and/or accurate hand/eye coordination required in the operation of tools, equipment, or machines.\n\nDEGREE 1: Duties do not normally involve operation of tools requiring fine movements.\nDEGREE 2: Requires accurate coarse movements OR accurate fine movements where speed is secondary.\nDEGREE 3: Accurate fine movements where speed is a consideration. Operation of equipment is a significant responsibility.\n\nDEFINITIONS:\n- "Coarse": Use of full hand or foot (band saws, drills, torches).\n- "Fine": Use of fingers (keyboarding, arc welding for precision, repairing instruments).`,
        opts:[{p:5,t:"Degree 1",d:"No fine movements."},{p:10,t:"Degree 2",d:"Fine movements; speed secondary."},{p:15,t:"Degree 3",d:"Fine movements; speed critical."}]
    },
    {
        id:'phys', t:'11. Physical Demands', pg:'Page 19',
        sum: `Intensity (Light vs Moderate/Heavy) and Frequency (Infrequent 1-2x/sem vs Frequent 3+x/sem).`,
        full: `PHYSICAL DEMANDS\n\nPHYSICAL DEMANDS INVOLVE:\nExertion (lifting, pushing, bending, carrying), repetitive eyestrain, standing, or repetitive muscle activity.\n\nMEASUREMENTS:\n- Light: Standing, typing, remaining in position.\n- Moderate/Heavy: Lifting, pushing, bending, carrying.\n\nFREQUENCY:\n- Infrequent: 1 or 2 times per semester.\n- Frequent: 3 or more times per semester.\n\nPOINTS MATRIX:\n- 1 pt: Light < 1 hr.\n- 2 pts: Light < 1 hr frequent.\n- 3 pts: Moderate/Heavy < 1 hr.\n- 4 pts: Moderate/Heavy < 1 hr frequent.\n- 5 pts: Light 1-2 hrs.\n- 6 pts: Light 1-2 hrs frequent.\n- 7 pts: Moderate/Heavy 1-2 hrs.\n- 8 pts: Moderate/Heavy 1-2 hrs frequent.\n- 9 pts: Light > 2 hrs.\n- 10 pts: Light > 2 hrs frequent.\n- 11 pts: Moderate/Heavy > 2 hrs.\n- 12 pts: Moderate/Heavy > 2 hrs frequent.`,
        opts:[{p:2,t:"2 Pts",d:"Light; <1hr; frequent."},{p:4,t:"4 Pts",d:"Moderate/Heavy; <1hr; frequent."},{p:8,t:"8 Pts",d:"Moderate/Heavy; 1-2hrs; frequent."},{p:12,t:"12 Pts",d:"Moderate/Heavy; >2hrs; frequent."}]
    },
    {
        id:'ment', t:'12. Mental Effort', pg:'Pages 20-21',
        sum: `Intensity and Duration (>1hr Moderate; >2hrs Long). Measures "backtracking" time lost if interrupted.`,
        full: `MENTAL EFFORT\n\nDEGREE 1: Low/normal concentration necessary for error free work. Occasional short periods.\nDEGREE 2: Moderate concentration for short duration (<1 hr) or occasional sustained (>1 hr). Normal pace.\nDEGREE 3: Moderate/high concentration for 2-3 hours for special projects. Busy pace.\nDEGREE 4: High concentration most of day due to volume/pressure. Pace extremely hectic.\n\nDEFINITIONS:\n- "Low/Normal Intensity": Person picks up where they left off; no backtracking; low need for detail.\n- "Moderate Intensity": Person spends time backtracking to determine where they left off; moderate need for detail.\n- "High Intensity": Close attention required most/all time; considerable backtracking; high need for detail.\n\nDURATION:\n- Short: 1 hour or less.\n- Moderate: >1 hour but <2 hours.\n- Long: >2 hours.`,
        opts:[{p:20,t:"Degree 1",d:"Low concentration; short periods."},{p:40,t:"Degree 2",d:"Moderate; occasional sustained (>1hr)."},{p:60,t:"Degree 3",d:"Moderate/High for projects; busy pace."},{p:80,t:"Degree 4",d:"High concentration; hectic pace."}]
    },
    {
        id:'inst', t:'13. Instruction Delivery', pg:'Pages 22-23',
        sum: `Ranges from basic area instructions to complex on-demand technical instruction directly affecting mastering of curriculum.`,
        full: `INSTRUCTION DELIVERY\n\nAlways in response to curricular needs of classes. Level does NOT include grading students.\n\nDEGREE 1: Gives instructions on proper use of area; non-complex steps.\nDEGREE 2: Assist students one-on-one with techniques; moderately complex steps.\nDEGREE 3: Give full class or one-on-one instruction; provide documentation/notes; support academic objectives.\nDEGREE 4: Full class or one-on-one instruction on demand for complex procedures; directly affects students' abilities to master required curriculum.\n\nSCOPE CONSIDERATIONS:\n- Library/Studio routines.\n- Moderately difficult procedures.\n- Very complex procedures.\n- Number of courses with significantly different content impacts scope.`,
        opts:[{p:25,t:"Degree 1",d:"Basic instructions; non-complex."},{p:50,t:"Degree 2",d:"Assist students one-on-one; moderately complex."},{p:75,t:"Degree 3",d:"Full class/one-on-one; provide documentation."},{p:100,t:"Degree 4",d:"Complex/On-demand; master curriculum."}]
    }
];

const bandingData = [
    {g:1, r:"0 - 460"}, {g:2, r:"461 - 510"}, {g:3, r:"511 - 560"}, {g:4, r:"561 - 610"},
    {g:5, r:"611 - 660"}, {g:6, r:"661 - 710"}, {g:7, r:"711 - 760"}, {g:8, r:"761+"}
];

const salaryMatrix = [
    {g:1, s:["$47,907","$49,621","$51,336","$53,051","$54,765","$56,480","-","-"]},
    {g:2, s:["$51,336","$53,051","$54,765","$56,480","$58,195","$59,909","$61,624","$63,339"]},
    {g:3, s:["$54,765","$56,480","$58,195","$59,909","$61,624","$63,339","$65,053","$66,768"]},
    {g:4, s:["$58,195","$59,909","$61,624","$63,339","$65,053","$66,768","$68,483","$70,197"]},
    {g:5, s:["$61,624","$63,339","$65,053","$66,768","$68,483","$70,197","$71,912","$73,627"]},
    {g:6, s:["$65,053","$66,768","$68,483","$70,197","$71,912","$73,627","$75,341","$77,056"]},
    {g:7, s:["$68,483","$70,197","$71,912","$73,627","$75,341","$77,056","$78,771","$80,485"]},
    {g:8, s:["$71,912","$73,627","$75,341","$77,056","$78,771","$80,485","$82,200","$83,915"]}
];

let cur = 0, scores = {}, rationales = {}, userData = { name: "", position: "", date: new Date().toLocaleDateString() };

window.onload = () => {
    let saved = localStorage.getItem('nscad_verbatim_manual_data');
    if (saved) {
        let p = JSON.parse(saved);
        scores = p.scores || {}; rationales = p.rationales || {}; userData = p.userData || userData;
    }
    render(); updateFooter();
};

function save() { localStorage.setItem('nscad_verbatim_manual_data', JSON.stringify({ scores, rationales, userData })); }

function render() {
    let el = document.getElementById('app-content');
    if (cur >= factors.length) { renderSummary(el); return; }

    let f = factors[cur];
    let profileHtml = (cur === 0) ? `
        <div class="card">
            <div class="profile-header"><div class="profile-icon">${userData.name ? userData.name[0].toUpperCase() : 'U'}</div><div><h2 style="margin:0; color:var(--pri);">Technician Evaluation</h2><p style="margin:0; font-size:0.8rem; color:var(--mute);">Factor Selection Workspace</p></div></div>
            <div class="details-grid">
                <div class="input-group"><label class="input-label">Technician Name</label><input type="text" class="input-field" value="${userData.name}" oninput="userData.name=this.value; save();" placeholder="Full Name"></div>
                <div class="input-group"><label class="input-label">Evaluation Date</label><input type="text" class="input-field" value="${userData.date}" disabled></div>
            </div>
            <div class="input-group"><label class="input-label">Current Position</label><input type="text" class="input-field" value="${userData.position}" oninput="userData.position=this.value; save();" placeholder="Job Title"></div>
        </div>` : "";

    let optionsHtml = f.isMulti ? 
        f.subs.map(sub => `<div class="sub-section"><div class="sub-title">${sub.t}</div><div style="display:grid; grid-template-columns: repeat(2, 1fr); gap:8px;">${sub.opts.map(o => `<div class="opt-item ${scores[f.id+'_'+sub.id]===o.v?'selected':''}" style="padding:10px; font-size:0.8rem;" onclick="setSubScore('${f.id}', '${sub.id}', ${o.v})">${o.t}</div>`).join('')}</div></div>`).join('') + `<div style="text-align:right; font-weight:800; padding:10px; color:var(--pri);">Factor Total: ${getMultiVal(f)} pts</div>` :
        f.opts.map(o => `<div class="opt-item ${scores[f.id]===o.p?'selected':''}" onclick="setScore('${f.id}', ${o.p})"><div class="opt-head"><span class="opt-name">${o.t}</span><span class="opt-score">${o.p} pts</span></div><div class="opt-desc">${o.d}</div></div>`).join('');

    el.innerHTML = profileHtml + `<div class="card"><div class="factor-header"><h2 class="factor-title">${f.t}</h2><div class="guide-btn-group"><button class="guide-btn" onclick="openGuide(${cur}, 'sum')">Summary</button><button class="guide-btn full" onclick="openGuide(${cur}, 'full')">Full Manual Text</button></div></div><div class="options-list">${optionsHtml}</div><details class="rationale-accordion" ${rationales[f.id] ? 'open' : ''}><summary>Rationale & Evidence</summary><div class="rationale-content"><textarea class="rationale-text" rows="4" oninput="rationales['${f.id}']=this.value; save();" placeholder="Enter supporting evidence here...">${rationales[f.id] || ''}</textarea></div></details></div>`;
    window.scrollTo(0,0);
}

function setScore(id, val) { scores[id] = val; save(); render(); updateFooter(); }
function setSubScore(fid, sid, val) { scores[fid+'_'+sid] = val; save(); render(); updateFooter(); }
function getMultiVal(f) { return f.subs.reduce((a, s) => a + (scores[f.id+'_'+s.id] || 0), 0); }
function calcT() { return factors.reduce((a, f) => a + (f.isMulti ? getMultiVal(f) : (scores[f.id] || 0)), 0); }
function getG(t) { return bandingData.find(b => { if(b.r.includes('+')) return t >= parseInt(b.r); return t >= parseInt(b.r.split(' - ')[0]) && t <= parseInt(b.r.split(' - ')[1]); })?.g || 1; }
function updateFooter() { let t = calcT(); document.getElementById('totalPoints').innerText = t; document.getElementById('payGroup').innerText = "Group " + getG(t); }

function renderSummary(el) {
    let t = calcT();
    let rows = factors.map(f => `<tr><td><strong>${f.t}</strong></td><td style="text-align:center;">${f.isMulti ? getMultiVal(f) : (scores[f.id]||0)}</td><td><div class="summary-evidence">${rationales[f.id]||'No evidence provided.'}</div></td></tr>`).join('');
    el.innerHTML = `<div class="card"><h2>Evaluation Summary</h2><div style="background:var(--sel); border:2px solid var(--pri); padding:20px; border-radius:8px; text-align:center; margin-bottom:20px;"><div style="font-size:2.5rem; font-weight:800;">${t} Points</div><div style="font-size:1.5rem; font-weight:700; color:var(--pri);">Group ${getG(t)}</div></div><table class="summary-table"><thead><tr><th>Factor</th><th style="text-align:center;">Pts</th><th>Evidence / Rationale</th></tr></thead><tbody>${rows}</tbody></table><br><button class="action-btn" onclick="window.print()" style="width:100%; justify-content:center; background:var(--pri); color:white;">Generate PDF Report</button></div>`;
}

function openGuide(i, type) { 
    document.getElementById('modalTitle').innerText = factors[i].t + (type === 'full' ? ' (Full Manual Text)' : ' (Summary)'); 
    document.getElementById('modalBody').innerHTML = `<span class="pg-ref">Manual Reference: ${factors[i].pg}</span>` + (type === 'full' ? factors[i].full : factors[i].sum); 
    document.getElementById('guideModal').style.display='flex'; 
}

function closeModal(id) { document.getElementById(id).style.display='none'; }
function openSal() {
    let currentG = getG(calcT());
    let b = document.getElementById('salaryBody'); b.innerHTML = "";
    salaryMatrix.forEach(r => {
        let range = bandingData.find(band => band.g === r.g).r;
        let h = `<tr class="${r.g === currentG ? 'active-row' : ''}"><td>Group ${r.g}</td><td class="pts-range-col">${range}</td>`;
        for (let i = 0; i < 8; i++) h += `<td>${r.s[i]}</td>`;
        b.innerHTML += h + `</tr>`;
    });
    document.getElementById('salaryModal').style.display='flex';
}

function nextStep() { if(cur<factors.length) { cur++; render(); } }
function prevStep() { if(cur>0) { cur--; render(); } }
function exportData() { let b = new Blob([JSON.stringify({ scores, rationales, userData })], {type:"text/plain"}); let a = document.createElement("a"); a.href=URL.createObjectURL(b); a.download=`Eval_${userData.name||'Member'}.nate`; a.click(); }
function importData(i) { let r = new FileReader(); r.onload=(e)=>{ let d=JSON.parse(e.target.result); scores=d.scores; rationales=d.rationales; userData=d.userData; cur=0; render(); updateFooter(); }; r.readAsText(i.files[0]); }
function hardReset() { if(confirm("Are you sure you want to reset all data?")) { localStorage.removeItem('nscad_verbatim_manual_data'); location.reload(); } }

render();
</script>
</body>
</html>
